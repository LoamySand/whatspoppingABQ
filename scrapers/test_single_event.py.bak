# test_single_event.py
"""
Test scraping a single known multi-day event
"""

import sys
sys.path.append('C:\\Users\\lanee\\Desktop\\whatspoppingABQ')

from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.chrome.options import Options
from webdriver_manager.chrome import ChromeDriverManager
from scrapers.visit_abq_detail_scraper import scrape_event_detail

# Setup Chrome
options = Options()
options.add_argument('--headless')
options.add_argument('--no-sandbox')
options.add_argument('--disable-dev-shm-usage')

driver = webdriver.Chrome(
    service=Service(ChromeDriverManager().install()),
    options=options
)

try:
    # Test with Spirit Soiree (known multi-day: Feb 13-14)
    url = "https://www.visitalbuquerque.org/event/spirit-soiree-love-legends-%26-light-in-old-town/62429/"
    
    print("Testing single event scraping...")
    print(f"URL: {url}")
    print()
    
    event = scrape_event_detail(driver, url)
    
    if event:
        print("Event details:")
        print("-" * 70)
        for key, value in event.items():
            if value is not None:
                print(f"  {key}: {value}")
        print()
        
        # Check multi-day
        if event.get('is_multi_day'):
            print("✓ Correctly detected as multi-day event!")
        else:
            print("✗ Failed to detect multi-day event")
            print(f"  Start: {event.get('event_start_date')}")
            print(f"  End: {event.get('event_end_date')}")
            print(f"  Start time: {event.get('event_start_time')}")
            print(f"  End time: {event.get('event_end_time')}")
    else:
        print("Failed to scrape event")
        
finally:
    driver.quit()